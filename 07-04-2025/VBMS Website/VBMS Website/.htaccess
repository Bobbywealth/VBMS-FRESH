# VBMS Website .htaccess Configuration
# This file ensures proper routing and forces .html extension usage

# Enable rewrite engine
RewriteEngine On

# Force HTTPS in production
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Remove trailing slashes
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{THE_REQUEST} /+([^?\s]+)\s [NC]
RewriteRule ^(.+)/ $1 [R=301,L]

# Redirect pages without .html extension to .html version for better consistency
# This ensures users always get the full-featured version with theme support

# Admin pages
RewriteRule ^admin-main-dashboard$ admin-main-dashboard.html [R=301,L]
RewriteRule ^admin-customers$ admin-customers.html [R=301,L]
RewriteRule ^admin-orders$ admin-orders.html [R=301,L]
RewriteRule ^admin-affiliates$ admin-affiliates.html [R=301,L]
RewriteRule ^admin-training$ admin-training.html [R=301,L]

# Customer pages
RewriteRule ^customer-dashboard$ customer-dashboard.html [R=301,L]
RewriteRule ^customer-inventory$ customer-inventory.html [R=301,L]
RewriteRule ^customer-monitoring$ customer-monitoring.html [R=301,L]
RewriteRule ^customer-ai-chat$ customer-ai-chat.html [R=301,L]
RewriteRule ^customer-settings$ customer-settings.html [R=301,L]
RewriteRule ^customer-tasks$ customer-tasks.html [R=301,L]
RewriteRule ^customer-calendar$ customer-calendar.html [R=301,L]
RewriteRule ^customer-orders$ customer-orders.html [R=301,L]
RewriteRule ^customer-training$ customer-training.html [R=301,L]
RewriteRule ^customer-uber-eats$ customer-uber-eats.html [R=301,L]

# Main application pages
RewriteRule ^dashboard$ dashboard.html [R=301,L]
RewriteRule ^billing$ billing.html [R=301,L]
RewriteRule ^inventory$ inventory.html [R=301,L]
RewriteRule ^reports$ reports.html [R=301,L]
RewriteRule ^settings$ settings.html [R=301,L]
RewriteRule ^support$ support.html [R=301,L]
RewriteRule ^help$ help.html [R=301,L]

# Additional common pages
RewriteRule ^login$ login.html [R=301,L]
RewriteRule ^register$ register.html [R=301,L]
RewriteRule ^monitoring$ monitoring.html [R=301,L]
RewriteRule ^orders$ orders.html [R=301,L]
RewriteRule ^calendar$ calendar.html [R=301,L]
RewriteRule ^training$ training.html [R=301,L]

# Default document
DirectoryIndex index.html

# Security headers
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-Content-Type-Options "nosniff"
Header always set X-XSS-Protection "1; mode=block"
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# Cache control for static assets
<FilesMatch "\.(css|js|jpg|jpeg|png|gif|ico|svg|woff|woff2|ttf|eot)$">
    Header set Cache-Control "public, max-age=31536000"
</FilesMatch>

# Cache control for HTML files (shorter cache for frequent updates)
<FilesMatch "\.html$">
    Header set Cache-Control "public, max-age=3600"
</FilesMatch>

# Protect sensitive files
<FilesMatch "(\.env|\.git|node_modules|vbms-backend)">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Error pages
ErrorDocument 404 /404.html
ErrorDocument 500 /500.html

# Compress text files
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>