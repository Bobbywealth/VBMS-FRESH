<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VBMS Setup Complete</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap" rel="stylesheet"/>
  <style>
    body {
      background: linear-gradient(135deg, #121212 60%, #201c13 100%);
      color: #fff;
      font-family: 'Inter', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1.2rem;
      overflow: hidden;
    }
    .vbms-logo {
      max-width: 100px;
      margin: 0 auto 1.2rem auto;
      display: block;
    }
    .confirmation-box {
      background: rgba(32,32,32,0.92);
      padding: 2.5rem 2.3rem 2.8rem 2.3rem;
      border-radius: 18px;
      max-width: 420px;
      width: 100%;
      text-align: center;
      box-shadow: 0 0 36px 2px #f0b90b33, 0 4px 40px #000a;
      position: relative;
      overflow: visible;
    }
    .gold-circle {
      margin: 0 auto 1rem auto;
      width: 64px;
      height: 64px;
      background: linear-gradient(135deg, #f0b90b 60%, #ffd659 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 26px 0 #f0b90b55;
      font-size: 2.6rem;
      color: #fff;
      animation: pop 1s cubic-bezier(.68,-0.55,.27,1.55);
    }
    @keyframes pop {
      0% { transform: scale(0.5); opacity: 0;}
      80% { transform: scale(1.08);}
      100% { transform: scale(1); opacity: 1;}
    }
    h1 {
      color: #f0b90b;
      margin-bottom: .6rem;
      font-weight: 800;
      font-size: 2.15rem;
      letter-spacing: .01em;
    }
    .celebrate {
      animation: swing 1.5s cubic-bezier(.68,-0.55,.27,1.55);
      display: inline-block;
      font-size: 2.3rem;
    }
    @keyframes swing {
      0% { transform: rotate(-12deg);}
      30% { transform: rotate(11deg);}
      55% { transform: rotate(-6deg);}
      70% { transform: rotate(4deg);}
      85% { transform: rotate(-2deg);}
      100% { transform: rotate(0deg);}
    }
    p {
      color: #e1c86d;
      margin-bottom: 1.7rem;
      font-size: 1.1rem;
      line-height: 1.6;
    }
    .btn-dashboard {
      background-color: #f0b90b;
      color: #191919;
      font-weight: 700;
      padding: 0.8rem 2.1rem;
      border: none;
      border-radius: 11px;
      font-size: 1.11rem;
      text-decoration: none;
      display: inline-block;
      box-shadow: 0 3px 16px #f0b90b55;
      transition: background 0.23s, box-shadow 0.18s;
    }
    .btn-dashboard:hover {
      background: #ffd659;
      color: #111;
      box-shadow: 0 3px 32px #f0b90b90;
    }
    .next-steps {
      margin-top: 1.7rem;
      text-align: left;
      font-size: 0.98rem;
      color: #ccc;
    }
    .next-steps ul {
      margin: 0.4rem 0 0 0;
      padding-left: 1.1rem;
      color: #ffe28b;
    }
    @media (max-width:600px){
      .confirmation-box { padding: 1.1rem 0.1rem 1.7rem 0.1rem;}
      .vbms-logo { max-width: 80px; }
      h1 { font-size: 1.4rem;}
      .gold-circle { width:48px;height:48px;font-size:1.6rem; }
    }
  </style>
</head>
<body>

  <div>
    <img src="https://iili.io/F7bM6Jt.md.png" class="vbms-logo" alt="VBMS Logo"/>
    <div class="confirmation-box">
      <div class="gold-circle"><i class="bi bi-check2"></i></div>
      <h1>Setup Complete!</h1>
      <span class="celebrate">ðŸŽ‰</span>
      <p>
        Thank you for completing your onboarding.<br>
        Your <strong>VBMS</strong> is now configured and ready to use.
      </p>
      <a href="dashboard.html" class="btn-dashboard">Go to Dashboard</a>
      <div class="next-steps mt-4">
        <strong>Next steps:</strong>
        <ul>
          <li>Invite your team and set up user roles</li>
          <li>Connect your POS or ordering systems</li>
          <li>Start managing your business with VBMS!</li>
        </ul>
      </div>
    </div>
  </div>
  <!-- Optional: Light confetti effect -->
  <script>
    // Confetti (optional: just for celebration)
    function confetti() {
      const colors = ['#f0b90b', '#ffd659', '#fffbe2'];
      for (let i = 0; i < 28; i++) {
        let conf = document.createElement('div');
        conf.style.position = 'fixed';
        conf.style.zIndex = '999';
        conf.style.top = (Math.random()*60+10)+'vh';
        conf.style.left = (Math.random()*96)+'vw';
        conf.style.width = (Math.random()*6+6)+'px';
        conf.style.height = conf.style.width;
        conf.style.background = colors[Math.floor(Math.random()*colors.length)];
        conf.style.opacity = Math.random()*0.6+0.32;
        conf.style.borderRadius = '60%';
        conf.style.transform = `rotate(${Math.random()*360}deg)`;
        conf.style.transition = 'top 2.2s cubic-bezier(.45,0,.55,1)';
        document.body.appendChild(conf);
        setTimeout(()=>conf.style.top='98vh', 200+Math.random()*200);
        setTimeout(()=>conf.remove(), 2400+Math.random()*300);
      }
    }
    setTimeout(confetti, 150);
  </script>
</script>
<script>
window.addEventListener("DOMContentLoaded", async () => {
  // decide whether we're running locally or in prod
  const API_BASE = window.location.hostname === 'localhost'
    ? 'http://localhost:5050'
    : 'https://vbms-backend.onrender.com';

  const wizardData = JSON.parse(localStorage.getItem("vbmsWizard") || "{}");
  if (!wizardData.email) return; // Don't send if no data

  try {
    const res = await fetch(`${API_BASE}/api/onboard`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(wizardData)
    });
    const data = await res.json();
    console.log("Onboarding saved:", data);
    
    // Mark onboarding as complete
    localStorage.setItem('vbms-wizard-complete', 'true');
    localStorage.removeItem('vbmsWizard');
    localStorage.removeItem('vbms-next-step');
    
    // Redirect to dashboard after a short delay
    setTimeout(() => {
      window.location.href = 'customer-dashboard.html';
    }, 2000);
    
  } catch (e) {
    console.error("Failed to save onboarding:", e);
    // Still mark as complete locally if server fails
    localStorage.setItem('vbms-wizard-complete', 'true');
    localStorage.removeItem('vbmsWizard');
    setTimeout(() => {
      window.location.href = 'customer-dashboard.html';
    }, 2000);
  }
});
</script>
</body>
</html>
